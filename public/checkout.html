<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <title>GymGym| Home</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <header>
        <nav>
            <a href="../storefront.html" class="logo-link">
                <h2 class ="logo">GYMGYM</h2>
            </a>
            <ul>
                <li><a href="../storefront.html">Home</a></li>
                <li><a href="../about.html">About</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../cart.html">Shopping Cart</a></li>
                <li><a href="../login.html" id="loginBtn">Sign Up/Login</a></li>
            </ul>
        </nav>
    </header>
    <main class="checkout-page">
        <h1>CHECK OUT PAGE</h1>
        <p class="cart-subtitle">Shopping cart</p>
    
        <div class="checkout-container">
          
          <div class="checkout-items">
            <h3>List of items</h3>
            <ul id ="cart-items"></ul> 
            <h4>Total Price: <span id="total-price">$0.00</span></h4>
          </div>
    
          
          <div class="checkout-payment">
            <h3>Payment Information</h3>
            <form>
              <label>Cardholder Name</label>
              <input type="text" placeholder="John Doe">
    
              <label>Card Number</label>
              <input type="text" placeholder="1234 5678 9012 3456">
    
              <label>Expiration Date</label>
              <input type="text" placeholder="MM/YY">
    
              <label>CVV</label>
              <input type="text" placeholder="123">
    
              <button type="submit" class="purchase-btn">Continue to Purchase</button>
            </form>
          </div>
        </div>
    
        <div class="checkout-buttons">
          <button class="cancel-btn" onclick="window.location.href='../cart.html'">Cancel</button>
          <button class="proceed-btn">Proceed</button>
        </div>
    
        <div class="checkout-policy">
          <h3>Policies / Disclaimers</h3>
          <p>All sales are final.</p>
        </div>
    
      </main>
    
<script>
async function loadCheckout() {
  try {
    const res = await fetch('/api/cart');
    const data = await res.json();

    // If backend requires login first:
    if (res.status === 401) {
      alert('Please log in to view your cart.');
      window.location.href = '../login.html';
      return;
    }

    const cartList = document.getElementById('cart-items');
    const totalSpan = document.getElementById('total-price');
    let total = 0;

    cartList.innerHTML = data.cart.map(item => {
      total += item.price * item.quantity;
      return `
        <li>
          <img src="${item.image_paths[0]}" width="60">
          ${item.name} — ${item.quantity} × $${item.price.toFixed(2)}
        </li>
      `;
    }).join('');

    totalSpan.textContent = `$${total.toFixed(2)}`;
  } catch (err) {
    console.error('Checkout load failed:', err);
  }
}
loadCheckout();
</script>
    <footer>
        <p>© 2025 GYMGYM — All Rights Reserved</p>
      </footer>
</body>
</html>